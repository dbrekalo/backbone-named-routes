!function(a,b){"function"==typeof define&&define.amd?define(["jquery","backbone","underscore"],b):"object"==typeof module&&module.exports?module.exports=b(require("jquery"),require("backbone"),require("underscore")):a.BaseView=b(a.jQuery,a.Backbone,a._)}(this,function(a,b,c){var d,e=this,f={routes:{}},g={pushState:!1,root:""},h={},i=e.location.protocol+"//"+e.location.host,j=/\((.*?)\)|(\(\?)?:\w+|\*\w+/g,k=/\((.*?)\)/g,l=/\:\w+/,m=/\(|\)/g,n=c.memoize(function(a){return a.replace(/\/$/,"")}),o=c.memoize(function(a,b){return a.slice(0,b.length)===b},function(a,b){return a+":"+b}),p=function(a,b){return a+(b?c.isArray(b)?":"+b.join(":"):":"+c.toArray(arguments).slice(1).join(":"):"")},q={register:function(a,b,d){return"string"==typeof a?(f.routes[a]=b,f[b]=d,h[b]=a):(f=a,c.each(f.routes,function(a,b){h[a]=b})),q},get:c.memoize(function(a,b){var d=h[a];return!c.isArray(b)&&(b=c.toArray(arguments).slice(1)),b.length&&(d=d.replace(j,function(a){var c=b.shift();return c?o(a,"(")?a.replace(l,c).replace(m,""):c:""})),d=d.replace(k,""),d.length?g.pushState?i+g.root+d:i+n(g.root)+"#"+d:i+n(g.root)},p),getWithQueryString:function(b,c,d){return 2===arguments.length&&(d=c,c=[]),q.get(b,c)+"?"+a.param(d)},navigate:function(){d.navigate.apply(d,arguments)},navigateToAlias:function(a,b,c){q.navigateToLink(q.get(a,b),c)},navigateToLink:function(b,c){var e=b instanceof a?b.attr("href"):b,f=n(g.root);o(e,i)&&(e=e.replace(i,"")),o(e,f)&&(e=e.replace(f,"")),o(e,"/")&&(e=e.slice(1)),!g.pushState&&o(e,"#")&&(e=e.slice(1)),d.navigate(e,{trigger:!!c})},start:function(a){var c=b.Router.extend(f);return d=new c,a&&q.setOptions(a),b.history.start(g),q},setOptions:function(b){return g=a.extend(g,b),q},setBaseUrl:function(a){return i=a,q},getOriginalRouter:function(){return d},getQueryParam:function(a){var b=e.location.search;if(b){var d=c.object(c.map(b.substring(1).split("&"),function(a){return a.split("=")}));return a?d[a]:d}}};return q});