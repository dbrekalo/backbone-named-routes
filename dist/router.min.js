!function($,s,t){"use strict";var o,i={routes:{}},e={pushState:!1,root:""},u={},r=window.location.protocol+"//"+window.location.host,p=/\((.*?)\)|(\(\?)?:\w+|\*\w+/g,f=/\((.*?)\)/g,l=/\:\w+/,g=/\(|\)/g,c=t.memoize(function(t){return t.replace(/\/$/,"")}),a=t.memoize(function(e,t){return e.slice(0,t.length)===t},function(t,e){return t+":"+e}),w=function(n,e){return n+(e?t.isArray(e)?":"+e.join(":"):":"+t.toArray(arguments).slice(1).join(":"):"")},n={register:function(e,r,o){return"string"==typeof e?(i.routes[e]=r,i[r]=o,u[r]=e):(i=e,t.each(i.routes,function(t,e){u[t]=e})),n},get:t.memoize(function(i,o){var n=u[i];return!t.isArray(o)&&(o=t.toArray(arguments).slice(1)),o.length&&(n=n.replace(p,function(e){var t=o.shift();return t?a(e,"(")?e.replace(l,t).replace(g,""):t:""})),n=n.replace(f,""),n.length?e.pushState?r+e.root+n:r+c(e.root)+"#"+n:r+c(e.root)},w),navigate:function(){o.navigate.apply(o,arguments)},navigateToAlias:function(t,e,r){n.navigateToLink(n.get(t,e),r)},navigateToLink:function(n,u){var t=n instanceof $?n.attr("href"):n,i=c(e.root);a(t,r)&&(t=t.replace(r,"")),a(t,i)&&(t=t.replace(i,"")),a(t,"/")&&(t=t.slice(1)),!e.pushState&&a(t,"#")&&(t=t.slice(1)),o.navigate(t,{trigger:!!u})},start:function(t){var r=s.Router.extend(i);return o=new r,t&&n.setOptions(t),s.history.start(e),n},setOptions:function(t){return e=$.extend(e,t),n},setBaseUrl:function(t){return r=t,n},getOriginalRouter:function(){return o},getQueryParam:function(n){var e,r=window.location.search;if(r)return e=t.object(t.map(r.substring(1).split("&"),function(t){return t.split("=")})),n?e[n]:e}};$.wk=$.wk||{},$.wk.router=n}(window.jQuery||window.Zepto,window.Backbone,window._);