!function(i,g,u){"use strict";var a,r={routes:{}},t={pushState:!1,root:""},s={},o=window.location.protocol+"//"+window.location.host,w=/\((.*?)\)|(\(\?)?:\w+|\*\w+/,e=function(t){e.cache=e.cache||{};var n=e.cache[t];return"undefined"!=typeof n?n:n=t.length&&"/"===t.substring(t.length-1)?t.substring(0,t.length-1):t},c=function(n,t){return n.slice(0,t.length)===t},n={register:function(t,e,o){return"string"==typeof t?(r.routes[t]=e,r[e]=o,s[e]=t):(r=t,u.each(r.routes,function(t,n){s[t]=n})),n},get:function(i,r){var n=s[i];return r&&r.length&&u.each(r,function(t){u.isObject(t)||(n=n.replace(w,t))}),n.length?t.pushState?o+t.root+n:o+e(t.root)+"#"+n:o+e(t.root)},navigate:function(){a.navigate.apply(a,arguments)},navigateToAlias:function(t,e,o){n.navigateToLink(n.get(t,e),o)},navigateToLink:function(r,s){var n=r instanceof i?r.attr("href"):r,u=e(t.root);c(n,o)&&(n=n.replace(o,"")),c(n,u)&&(n=n.replace(u,"")),c(n,"/")&&(n=n.slice(1)),!t.pushState&&c(n,"#")&&(n=n.slice(1)),a.navigate(n,{trigger:!s})},start:function(e){var o=g.Router.extend(r);return a=new o,e&&n.setOptions(e),g.history.start(t),n},setOptions:function(e){return t=i.extend(t,e),n}};i.wk=i.wk||{},i.wk.router=n}(window.jQuery||window.Zepto,window.Backbone,window._);